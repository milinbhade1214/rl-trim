stty: 'standard input': Inappropriate ioctl for device
2024-06-10 15:14:55.839064: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-06-10 15:14:55.892803: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-10 15:14:56.826123: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
=> Saving logs to ./logs/Llama-2-7b-hf_wikitext_r0.6_search-run4
=> Output path: ./logs/Llama-2-7b-hf_wikitext_r0.6_search-run4...
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:02<00:05,  2.69s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:05<00:02,  2.58s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:06<00:00,  2.22s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:06<00:00,  2.33s/it]
args:
Namespace(job='train', suffix=None, model='Llama-2-7b-hf', dataset='wikitext', data_root='./dataset', tokenizer_path='/data/home/milinbhade/LLaMa/hf_llama', model_path='/data/home/milinbhade/LLaMa/hf_llama', preserve_ratio=0.6, lbound=0.5, rbound=1.0, reward='perp_reward', acc_metric='acc5', use_real_val=False, ckpt_path='./checkpoint', n_calibration_batches=5, n_points_per_layer=10, channel_round=1, hidden1=300, hidden2=300, lr_c=0.001, lr_a=0.001, warmup=100, discount=0.99, bsize=100, rmsize=10000, window_length=1, tau=0.01, init_delta=0.5, delta_decay=0.95, max_episode_length=1000000000.0, output='./logs/Llama-2-7b-hf_wikitext_r0.6_search-run4', debug=False, init_w=0.003, train_episode=200, epsilon=50000, seed=2024, n_gpu=1, n_worker=16, data_bsize=4, resume='default', ratios=None, channels=None, export_path=None, use_new_input=False, pr_ratio=0.8, export_num=None)
Building Index
=> Prunable layer idx:  [61, 67, 75, 81, 89, 95, 103, 109, 117, 123, 131, 137, 145, 151, 159, 165, 173, 179, 187, 193, 201, 207, 215, 221, 229, 235, 243, 249, 257, 263, 271, 277, 285, 291, 299, 305, 313, 319, 327, 333, 341, 347, 355, 361, 369, 375, 383, 389, 397, 403, 411, 417, 425, 431]
=> Prunable Ops:  [LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
), LlamaSdpaAttention(
  (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (v_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
  (rotary_emb): LlamaRotaryEmbedding()
), LlamaMLP(
  (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
  (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
  (act_fn): SiLU()
)]
=> Layer Type Dict:  {61: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 67: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 75: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 81: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 89: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 95: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 103: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 109: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 117: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 123: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 131: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 137: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 145: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 151: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 159: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 165: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 173: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 179: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 187: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 193: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 201: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 207: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 215: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 221: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 229: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 235: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 243: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 249: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 257: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 263: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 271: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 277: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 285: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 291: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 299: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 305: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 313: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 319: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 327: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 333: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 341: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 347: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 355: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 361: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 369: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 375: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 383: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 389: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 397: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 403: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 411: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 417: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>, 425: <class 'transformers.models.llama.modeling_llama.LlamaSdpaAttention'>, 431: <class 'transformers.models.llama.modeling_llama.LlamaMLP'>}
=> Prunable layers: 54
Extracting Layer Information
=> Extracting information...
Batch :  0
First Batch
Batch :  1
Batch :  2
Batch :  3
Batch :  4
Batch :  5
Building State Embedding
Preparing Calibration Input from wikitext for wanda


************************  Preparing Calibration Input from wikitext for wanda  ************************


dataset loading complete
GPU memory occupied: 17630 MB.
Trying to load using pretrained
GPU memory occupied: 17632 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.77it/s]WikiText Validation:  13%|█▎        | 2/15 [00:00<00:05,  2.58it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:05,  2.07it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:05,  1.89it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.80it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.70it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.69it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.67it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.64it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:03,  1.65it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.63it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.62it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.64it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.69it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.66it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]
=> original acc: 4.914%
=> original weight size: 5464.1295 M param
=> FLOPs:
[168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925, 168.448005, 315.729925]
=> original FLOPs: 13072.8041 M
=> expected preserved computation: 7843.6825 M
=> original weight size: 5464.1295 M param
** Actual replay buffer size: 540000
N_b_states:  10
Nb_actions:  1
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.71it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.65it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.67it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.66it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.63it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.65it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.61it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.63it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.62it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.63it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.65it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.61it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.63it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.66it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.62it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.63it/s]
Perplexity after final layer :  27.45968246459961
Current Flops before reward:  5691008022
Perplexity in reward function  27.45968246459961
[92m New best reward: -0.7441, acc: 27.4597, compress: 0.4353[00m
[92m New best policy: [0.59375, 0.6991279069767442, 0.5, 0.5, 0.5, 0.5, 0.71875, 0.6794149709302325, 0.5, 0.5, 0.5, 0.7526344476744186, 0.59375, 0.9617550872093024, 0.65625, 0.6066497093023255, 0.5, 0.5, 0.65625, 0.7357376453488372, 0.5, 0.5, 0.96875, 0.5, 0.5, 0.7682594476744186, 0.8125, 0.5440588662790697, 0.5, 0.5, 0.5, 0.7402797965116279, 0.5, 0.5, 0.875, 0.5, 0.78125, 0.7589934593023255, 0.5, 0.5, 0.5, 0.5, 0.59375, 0.8373001453488372, 0.90625, 0.5, 0.5, 0.8953488372093024, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5][00m
[92m New best d primes: [19, 7696, 16, 5504, 16, 5504, 23, 7479, 16, 5504, 16, 8285, 19, 10587, 21, 6678, 16, 5504, 21, 8099, 16, 5504, 31, 5504, 16, 8457, 26, 5989, 16, 5504, 16, 8149, 16, 5504, 28, 5504, 25, 8355, 16, 5504, 16, 5504, 19, 9217, 29, 5504, 16, 9856, 16, 5504, 16, 5504, 16, 5504][00m
#0: episode_reward:-0.7441 acc: 27.4597, ratio: 0.4353
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.66it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.65it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.67it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.62it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.64it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.68it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.64it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.66it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.64it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.66it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.63it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.65it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.63it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.66it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.63it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.65it/s]
Perplexity after final layer :  17.499914169311523
Current Flops before reward:  5697960342
Perplexity in reward function  17.499914169311523
[92m New best reward: -0.6429, acc: 17.4999, compress: 0.4359[00m
[92m New best policy: [0.5, 0.5, 0.90625, 0.874000726744186, 0.5, 0.9997274709302325, 0.5, 0.5, 0.84375, 0.8802688953488372, 0.6875, 0.5, 0.5625, 0.6944949127906976, 0.8125, 0.5, 0.5, 0.8490188953488372, 0.5, 0.6771438953488372, 0.5, 0.6816860465116279, 0.5, 0.5489643895348837, 0.84375, 0.7365552325581395, 0.5, 0.5, 0.78125, 0.5, 0.59375, 0.5, 0.5, 0.5, 0.71875, 0.5, 0.5, 0.6356286337209303, 0.84375, 0.5, 0.5, 0.7116642441860465, 0.875, 0.5348837209302325, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5][00m
[92m New best d primes: [16, 5504, 29, 9621, 16, 11005, 16, 5504, 27, 9690, 22, 5504, 18, 7645, 26, 5504, 16, 9346, 16, 7454, 16, 7504, 16, 6043, 27, 8108, 16, 5504, 25, 5504, 19, 5504, 16, 5504, 23, 5504, 16, 6997, 27, 5504, 16, 7834, 28, 5888, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504][00m
#1: episode_reward:-0.6429 acc: 17.4999, ratio: 0.4359
GPU memory occupied: 17634 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.73it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.64it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.66it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.62it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.63it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.60it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.63it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.65it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.62it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.61it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.65it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.62it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.64it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.65it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.64it/s]
Perplexity after final layer :  56.41202926635742
Current Flops before reward:  5663568318
Perplexity in reward function  56.41202926635742
#2: episode_reward:-0.9056 acc: 56.4120, ratio: 0.4332
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.63it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.66it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.63it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.63it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.65it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.61it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.64it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.60it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.63it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.64it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.61it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.63it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.64it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.67it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.69it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.64it/s]
Perplexity after final layer :  20.020538330078125
Current Flops before reward:  5642994630
Perplexity in reward function  20.020538330078125
#3: episode_reward:-0.6729 acc: 20.0205, ratio: 0.4317
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.62it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.65it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.61it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.64it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.62it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.62it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.65it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.61it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.63it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.61it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.62it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.64it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:08<00:01,  1.61it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.63it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.61it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.62it/s]
Perplexity after final layer :  27.28655433654785
Current Flops before reward:  5708122470
Perplexity in reward function  27.28655433654785
#4: episode_reward:-0.7428 acc: 27.2866, ratio: 0.4366
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.64it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.66it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.61it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.63it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.60it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.63it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.61it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.63it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.61it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.64it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.60it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:08<00:01,  1.59it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.62it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.64it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.63it/s]
Perplexity after final layer :  24.824058532714844
Current Flops before reward:  5893972134
Perplexity in reward function  24.824058532714844
#5: episode_reward:-0.7226 acc: 24.8241, ratio: 0.4509
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.78it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.73it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.64it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.66it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.61it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.64it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.64it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.62it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.64it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.61it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.63it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.60it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.62it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.60it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.63it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.63it/s]
Perplexity after final layer :  43.713199615478516
Current Flops before reward:  5786530062
Perplexity in reward function  43.713199615478516
#6: episode_reward:-0.8492 acc: 43.7132, ratio: 0.4426
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.86it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.70it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.69it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.70it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.69it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.69it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.68it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:03,  1.65it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.70it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.69it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.68it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.70it/s]
Perplexity after final layer :  39.600059509277344
Current Flops before reward:  5652088542
Perplexity in reward function  39.600059509277344
#7: episode_reward:-0.8261 acc: 39.6001, ratio: 0.4324
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.71it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.66it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.65it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.67it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.62it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.64it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.65it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.63it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.65it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.62it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.64it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.62it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.63it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.65it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.65it/s]
Perplexity after final layer :  43.54348373413086
Current Flops before reward:  5714326038
Perplexity in reward function  43.54348373413086
#8: episode_reward:-0.8478 acc: 43.5435, ratio: 0.4371
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.71it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.65it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.67it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.62it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.64it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.63it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.63it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.65it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.61it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.63it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.60it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.62it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.61it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.61it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.61it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.63it/s]
Perplexity after final layer :  39.027828216552734
Current Flops before reward:  5642404566
Perplexity in reward function  39.027828216552734
#9: episode_reward:-0.8228 acc: 39.0278, ratio: 0.4316
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.78it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.64it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.66it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.61it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.64it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.61it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.62it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.61it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.63it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.60it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.58it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.63it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.63it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.65it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.61it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.62it/s]
Perplexity after final layer :  89.51853942871094
Current Flops before reward:  5764710462
Perplexity in reward function  89.51853942871094
#10: episode_reward:-1.0101 acc: 89.5185, ratio: 0.4410
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.86it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.70it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.70it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.70it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.69it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.69it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.66it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.70it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.65it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.66it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.67it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.63it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.68it/s]
Perplexity after final layer :  35.715511322021484
Current Flops before reward:  5803639086
Perplexity in reward function  35.715511322021484
#11: episode_reward:-0.8039 acc: 35.7155, ratio: 0.4439
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.64it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.66it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.65it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.63it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.65it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.61it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.63it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.60it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.62it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.60it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.62it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:08<00:01,  1.59it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.62it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.59it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.62it/s]
Perplexity after final layer :  21.507841110229492
Current Flops before reward:  5654711358
Perplexity in reward function  21.507841110229492
#12: episode_reward:-0.6890 acc: 21.5078, ratio: 0.4326
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.70it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.69it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.70it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  38.40641784667969
Current Flops before reward:  5645368734
Perplexity in reward function  38.40641784667969
#13: episode_reward:-0.8192 acc: 38.4064, ratio: 0.4318
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 17632 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.74it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.70it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.69it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.63it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.65it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.63it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.64it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.65it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.62it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:03,  1.64it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.60it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.62it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.60it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.60it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.62it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.63it/s]
Perplexity after final layer :  28.60409164428711
Current Flops before reward:  5703397062
Perplexity in reward function  28.60409164428711
#14: episode_reward:-0.7534 acc: 28.6041, ratio: 0.4363
GPU memory occupied: 17632 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.86it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.81it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.79it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.78it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.81it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.79it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.78it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
Perplexity after final layer :  33.513427734375
Current Flops before reward:  5632484358
Perplexity in reward function  33.513427734375
#15: episode_reward:-0.7885 acc: 33.5134, ratio: 0.4309
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.99it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  58.57024002075195
Current Flops before reward:  5671657710
Perplexity in reward function  58.57024002075195
#16: episode_reward:-0.9141 acc: 58.5702, ratio: 0.4339
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.82it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.65it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]
Perplexity after final layer :  71.8097152709961
Current Flops before reward:  5684641062
Perplexity in reward function  71.8097152709961
#17: episode_reward:-0.9600 acc: 71.8097, ratio: 0.4348
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.05it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.74it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.72it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  33.3853759765625
Current Flops before reward:  5693253294
Perplexity in reward function  33.3853759765625
#18: episode_reward:-0.7880 acc: 33.3854, ratio: 0.4355
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.82it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  44.81440353393555
Current Flops before reward:  5606395422
Perplexity in reward function  44.81440353393555
#19: episode_reward:-0.8536 acc: 44.8144, ratio: 0.4289
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.86it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.81it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.79it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.78it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.78it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.78it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.79it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.84it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.76it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.82it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
Perplexity after final layer :  19.662677764892578
Current Flops before reward:  5683898910
Perplexity in reward function  19.662677764892578
#20: episode_reward:-0.6690 acc: 19.6627, ratio: 0.4348
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.07it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.74it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.81it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.78it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  31.87063980102539
Current Flops before reward:  5700542718
Perplexity in reward function  31.87063980102539
#21: episode_reward:-0.7776 acc: 31.8706, ratio: 0.4361
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 17634 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.02it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.83it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.70it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  46.809959411621094
Current Flops before reward:  5636065830
Perplexity in reward function  46.809959411621094
#22: episode_reward:-0.8635 acc: 46.8100, ratio: 0.4311
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.89it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.86it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.89it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:05,  1.87it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.83it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.82it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.82it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.79it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.78it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.79it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.84it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.82it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.82it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
Perplexity after final layer :  15.275222778320312
Current Flops before reward:  5684772246
Perplexity in reward function  15.275222778320312
[92m New best reward: -0.6123, acc: 15.2752, compress: 0.4349[00m
[92m New best policy: [0.5, 0.5, 0.5, 0.9918241279069767, 0.9375, 0.5812136627906976, 0.6875, 0.8364825581395349, 0.6875, 0.6654251453488372, 0.5, 0.5, 0.71875, 0.9984556686046512, 0.5, 0.5, 0.8125, 0.7320130813953488, 0.875, 0.5, 0.5, 0.7335574127906976, 0.5, 0.5, 0.84375, 0.9694767441860465, 0.5, 0.5, 0.5, 0.5, 0.71875, 0.5, 0.8125, 0.6589752906976745, 1.0, 0.5, 0.5, 0.5, 0.5, 0.6449854651162791, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5][00m
[92m New best d primes: [16, 5504, 16, 10918, 30, 6398, 22, 9208, 22, 7325, 16, 5504, 23, 10991, 16, 5504, 26, 8058, 28, 5504, 16, 8075, 16, 5504, 27, 10672, 16, 5504, 16, 5504, 23, 5504, 26, 7254, 32, 5504, 16, 5504, 16, 7100, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504][00m
#23: episode_reward:-0.6123 acc: 15.2752, ratio: 0.4349
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.86it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:06,  1.67it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.78it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  28.259971618652344
Current Flops before reward:  5793752718
Perplexity in reward function  28.259971618652344
#24: episode_reward:-0.7512 acc: 28.2600, ratio: 0.4432
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.71it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.71it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  24.873401641845703
Current Flops before reward:  5649875022
Perplexity in reward function  24.873401641845703
#25: episode_reward:-0.7217 acc: 24.8734, ratio: 0.4322
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.71it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.81it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.82it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.81it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.80it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
Perplexity after final layer :  18.551538467407227
Current Flops before reward:  5680974726
Perplexity in reward function  18.551538467407227
#26: episode_reward:-0.6560 acc: 18.5515, ratio: 0.4346
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.94it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.84it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  32.227420806884766
Current Flops before reward:  5719202358
Perplexity in reward function  32.227420806884766
#27: episode_reward:-0.7802 acc: 32.2274, ratio: 0.4375
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.93it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.78it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.70it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.69it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  26.356355667114258
Current Flops before reward:  5682700230
Perplexity in reward function  26.356355667114258
#28: episode_reward:-0.7348 acc: 26.3564, ratio: 0.4347
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.82it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.79it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.77it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
Perplexity after final layer :  49.16908645629883
Current Flops before reward:  5646693438
Perplexity in reward function  49.16908645629883
#29: episode_reward:-0.8747 acc: 49.1691, ratio: 0.4319
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 17632 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.96it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.85it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.81it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.79it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.80it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.76it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.82it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.85it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
Perplexity after final layer :  28.864356994628906
Current Flops before reward:  5673338334
Perplexity in reward function  28.864356994628906
#30: episode_reward:-0.7552 acc: 28.8644, ratio: 0.4340
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.87it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.79it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  63.47127914428711
Current Flops before reward:  5685972558
Perplexity in reward function  63.47127914428711
#31: episode_reward:-0.9323 acc: 63.4713, ratio: 0.4349
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.01it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  18.881071090698242
Current Flops before reward:  5650808070
Perplexity in reward function  18.881071090698242
#32: episode_reward:-0.6598 acc: 18.8811, ratio: 0.4323
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.71it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  37.388336181640625
Current Flops before reward:  5684038782
Perplexity in reward function  37.388336181640625
#33: episode_reward:-0.8134 acc: 37.3883, ratio: 0.4348
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.64it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.67it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  29.34433937072754
Current Flops before reward:  5685546150
Perplexity in reward function  29.34433937072754
#34: episode_reward:-0.7590 acc: 29.3443, ratio: 0.4349
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.71it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.71it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.71it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  44.103580474853516
Current Flops before reward:  5652734790
Perplexity in reward function  44.103580474853516
#35: episode_reward:-0.8503 acc: 44.1036, ratio: 0.4324
GPU memory occupied: 17634 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.84it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  51.20620346069336
Current Flops before reward:  6227106798
Perplexity in reward function  51.20620346069336
#36: episode_reward:-0.8876 acc: 51.2062, ratio: 0.4763
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.70it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  17.505088806152344
Current Flops before reward:  5649807078
Perplexity in reward function  17.505088806152344
#37: episode_reward:-0.6428 acc: 17.5051, ratio: 0.4322
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 17634 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.63it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:08,  1.57it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.72it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.77it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  23.763978958129883
Current Flops before reward:  5705699958
Perplexity in reward function  23.763978958129883
#38: episode_reward:-0.7117 acc: 23.7640, ratio: 0.4365
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.88it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.84it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.83it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.81it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.79it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  51.8885612487793
Current Flops before reward:  5692220814
Perplexity in reward function  51.8885612487793
#39: episode_reward:-0.8871 acc: 51.8886, ratio: 0.4354
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.85it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.82it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.78it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.79it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.84it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.85it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
Perplexity after final layer :  68.52862548828125
Current Flops before reward:  5670523446
Perplexity in reward function  68.52862548828125
#40: episode_reward:-0.9494 acc: 68.5286, ratio: 0.4338
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.85it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.79it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.70it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.70it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.70it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  25.390153884887695
Current Flops before reward:  5719102926
Perplexity in reward function  25.390153884887695
#41: episode_reward:-0.7267 acc: 25.3902, ratio: 0.4375
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.84it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.77it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  32.126922607421875
Current Flops before reward:  5643825174
Perplexity in reward function  32.126922607421875
#42: episode_reward:-0.7791 acc: 32.1269, ratio: 0.4317
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.78it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  72.36128997802734
Current Flops before reward:  5953752102
Perplexity in reward function  72.36128997802734
#43: episode_reward:-0.9637 acc: 72.3613, ratio: 0.4554
GPU memory occupied: 17632 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.87it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.84it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  28.51991081237793
Current Flops before reward:  5714156766
Perplexity in reward function  28.51991081237793
#44: episode_reward:-0.7528 acc: 28.5199, ratio: 0.4371
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.00it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  38.045372009277344
Current Flops before reward:  5732698422
Perplexity in reward function  38.045372009277344
#45: episode_reward:-0.8176 acc: 38.0454, ratio: 0.4385
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 17632 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.63it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  37.0772590637207
Current Flops before reward:  5644599534
Perplexity in reward function  37.0772590637207
#46: episode_reward:-0.8113 acc: 37.0773, ratio: 0.4318
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.04it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.84it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  223.73236083984375
Current Flops before reward:  5639534214
Perplexity in reward function  223.73236083984375
#47: episode_reward:-1.2148 acc: 223.7324, ratio: 0.4314
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.61it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.64it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.69it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  52.19923782348633
Current Flops before reward:  5693382126
Perplexity in reward function  52.19923782348633
#48: episode_reward:-0.8884 acc: 52.1992, ratio: 0.4355
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.87it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.80it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.76it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.77it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
Perplexity after final layer :  47.29171371459961
Current Flops before reward:  5702752254
Perplexity in reward function  47.29171371459961
#49: episode_reward:-0.8663 acc: 47.2917, ratio: 0.4362
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.85it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.79it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  43.6222038269043
Current Flops before reward:  5973377190
Perplexity in reward function  43.6222038269043
#50: episode_reward:-0.8499 acc: 43.6222, ratio: 0.4569
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.99it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.83it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.80it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  22.59933853149414
Current Flops before reward:  5691227598
Perplexity in reward function  22.59933853149414
#51: episode_reward:-0.7004 acc: 22.5993, ratio: 0.4353
GPU memory occupied: 17634 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.04it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  58.404884338378906
Current Flops before reward:  5638802646
Perplexity in reward function  58.404884338378906
#52: episode_reward:-0.9133 acc: 58.4049, ratio: 0.4313
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.06it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.81it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.77it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  46.08203125
Current Flops before reward:  5688141198
Perplexity in reward function  46.08203125
#53: episode_reward:-0.8604 acc: 46.0820, ratio: 0.4351
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.78it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.73it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  56.6275520324707
Current Flops before reward:  5654214390
Perplexity in reward function  56.6275520324707
#54: episode_reward:-0.9064 acc: 56.6276, ratio: 0.4325
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.87it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.77it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  44.581451416015625
Current Flops before reward:  5682463734
Perplexity in reward function  44.581451416015625
#55: episode_reward:-0.8529 acc: 44.5815, ratio: 0.4347
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.99it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.78it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.65it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  22.63852882385254
Current Flops before reward:  5648048190
Perplexity in reward function  22.63852882385254
#56: episode_reward:-0.7005 acc: 22.6385, ratio: 0.4320
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.65it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:08,  1.58it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.71it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  124.43765258789062
Current Flops before reward:  5682857022
Perplexity in reward function  124.43765258789062
#57: episode_reward:-1.0835 acc: 124.4377, ratio: 0.4347
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.93it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.84it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.79it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  90.70025634765625
Current Flops before reward:  5865059166
Perplexity in reward function  90.70025634765625
#58: episode_reward:-1.0139 acc: 90.7003, ratio: 0.4486
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 17632 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.85it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.86it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.94it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:05,  1.92it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.82it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
Perplexity after final layer :  28.607589721679688
Current Flops before reward:  5630301150
Perplexity in reward function  28.607589721679688
#59: episode_reward:-0.7529 acc: 28.6076, ratio: 0.4307
GPU memory occupied: 17632 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.93it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.80it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.71it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  26.68457794189453
Current Flops before reward:  5687868510
Perplexity in reward function  26.68457794189453
#60: episode_reward:-0.7377 acc: 26.6846, ratio: 0.4351
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.94it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.86it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.85it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.81it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.76it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  24.371723175048828
Current Flops before reward:  5697122742
Perplexity in reward function  24.371723175048828
#61: episode_reward:-0.7173 acc: 24.3717, ratio: 0.4358
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.91it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.68it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.68it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.76it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  45.045108795166016
Current Flops before reward:  5671617990
Perplexity in reward function  45.045108795166016
#62: episode_reward:-0.8552 acc: 45.0451, ratio: 0.4338
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  57.57512283325195
Current Flops before reward:  5704737774
Perplexity in reward function  57.57512283325195
#63: episode_reward:-0.9105 acc: 57.5751, ratio: 0.4364
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.89it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.90it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.80it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.87it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.82it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.80it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.78it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.80it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.83it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.81it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
Perplexity after final layer :  37.69681930541992
Current Flops before reward:  5641108806
Perplexity in reward function  37.69681930541992
#64: episode_reward:-0.8150 acc: 37.6968, ratio: 0.4315
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.84it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  80.70199584960938
Current Flops before reward:  5707566510
Perplexity in reward function  80.70199584960938
#65: episode_reward:-0.9864 acc: 80.7020, ratio: 0.4366
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.89it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.78it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.70it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.77it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  29.44190788269043
Current Flops before reward:  5659982142
Perplexity in reward function  29.44190788269043
#66: episode_reward:-0.7596 acc: 29.4419, ratio: 0.4330
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 17634 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.10it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.87it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.85it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.82it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.80it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.81it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.86it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.83it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.81it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.80it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.82it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.83it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.81it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
Perplexity after final layer :  22.767147064208984
Current Flops before reward:  5591631102
Perplexity in reward function  22.767147064208984
#67: episode_reward:-0.7015 acc: 22.7671, ratio: 0.4277
GPU memory occupied: 17634 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.90it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.81it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.81it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.85it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.76it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.79it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.77it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
Perplexity after final layer :  25.20810890197754
Current Flops before reward:  5648617350
Perplexity in reward function  25.20810890197754
#68: episode_reward:-0.7246 acc: 25.2081, ratio: 0.4321
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.81it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.83it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.81it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.80it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.78it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
Perplexity after final layer :  381.4591064453125
Current Flops before reward:  5654943150
Perplexity in reward function  381.4591064453125
#69: episode_reward:-1.3348 acc: 381.4591, ratio: 0.4326
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.99it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  41.46869659423828
Current Flops before reward:  5773794246
Perplexity in reward function  41.46869659423828
#70: episode_reward:-0.8372 acc: 41.4687, ratio: 0.4417
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.91it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.68it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.67it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  35.7434196472168
Current Flops before reward:  5632783374
Perplexity in reward function  35.7434196472168
#71: episode_reward:-0.8030 acc: 35.7434, ratio: 0.4309
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21734 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.06it/s]WikiText Validation:  13%|█▎        | 2/15 [00:00<00:06,  1.99it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.98it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:05,  1.95it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.96it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.95it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.93it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.92it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.91it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.91it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:05<00:02,  1.92it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.91it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:06<00:01,  1.93it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.93it/s]WikiText Validation: 100%|██████████| 15/15 [00:07<00:00,  1.93it/s]WikiText Validation: 100%|██████████| 15/15 [00:07<00:00,  1.94it/s]
Perplexity after final layer :  44.39745330810547
Current Flops before reward:  5683760934
Perplexity in reward function  44.39745330810547
#72: episode_reward:-0.8520 acc: 44.3975, ratio: 0.4348
GPU memory occupied: 21734 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  2.00it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.84it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.76it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  36.28745651245117
Current Flops before reward:  5619536742
Perplexity in reward function  36.28745651245117
#73: episode_reward:-0.8063 acc: 36.2875, ratio: 0.4299
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.65it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.82it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.67it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  30.005287170410156
Current Flops before reward:  5672600166
Perplexity in reward function  30.005287170410156
#74: episode_reward:-0.7639 acc: 30.0053, ratio: 0.4339
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.63it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.71it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.68it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.78it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.70it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.65it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  44.56101989746094
Current Flops before reward:  5681329470
Perplexity in reward function  44.56101989746094
#75: episode_reward:-0.8528 acc: 44.5610, ratio: 0.4346
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.04it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.88it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.88it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:05,  1.84it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.81it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.81it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.67it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
Perplexity after final layer :  35.76399612426758
Current Flops before reward:  5694093246
Perplexity in reward function  35.76399612426758
#76: episode_reward:-0.8035 acc: 35.7640, ratio: 0.4356
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.82it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.81it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.80it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.76it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
Perplexity after final layer :  25.603923797607422
Current Flops before reward:  5772113430
Perplexity in reward function  25.603923797607422
#77: episode_reward:-0.7288 acc: 25.6039, ratio: 0.4415
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 17644 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.84it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.77it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  67.36858367919922
Current Flops before reward:  5927997654
Perplexity in reward function  67.36858367919922
#78: episode_reward:-0.9474 acc: 67.3686, ratio: 0.4535
GPU memory occupied: 17644 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.96it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.86it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.86it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.78it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  35.04378128051758
Current Flops before reward:  5674439214
Perplexity in reward function  35.04378128051758
#79: episode_reward:-0.7988 acc: 35.0438, ratio: 0.4341
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.80it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.81it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.66it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  62.871578216552734
Current Flops before reward:  5685441750
Perplexity in reward function  62.871578216552734
#80: episode_reward:-0.9301 acc: 62.8716, ratio: 0.4349
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.63it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.69it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  62.62309265136719
Current Flops before reward:  5680117854
Perplexity in reward function  62.62309265136719
#81: episode_reward:-0.9292 acc: 62.6231, ratio: 0.4345
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.78it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  45.785884857177734
Current Flops before reward:  5688779214
Perplexity in reward function  45.785884857177734
#82: episode_reward:-0.8589 acc: 45.7859, ratio: 0.4352
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.67it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.69it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  90.08501434326172
Current Flops before reward:  5705997798
Perplexity in reward function  90.08501434326172
#83: episode_reward:-1.0111 acc: 90.0850, ratio: 0.4365
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.80it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.78it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.76it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  29.074045181274414
Current Flops before reward:  5648933742
Perplexity in reward function  29.074045181274414
#84: episode_reward:-0.7567 acc: 29.0740, ratio: 0.4321
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.98it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.79it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.78it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  41.07868576049805
Current Flops before reward:  5806505454
Perplexity in reward function  41.07868576049805
#85: episode_reward:-0.8353 acc: 41.0787, ratio: 0.4442
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.92it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.68it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  60.39796829223633
Current Flops before reward:  5651919534
Perplexity in reward function  60.39796829223633
#86: episode_reward:-0.9209 acc: 60.3980, ratio: 0.4323
GPU memory occupied: 17644 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.88it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.82it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.79it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  86.16117858886719
Current Flops before reward:  5661300246
Perplexity in reward function  86.16117858886719
#87: episode_reward:-1.0007 acc: 86.1612, ratio: 0.4331
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.90it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.82it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.71it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.69it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  42.27750015258789
Current Flops before reward:  5720256006
Perplexity in reward function  42.27750015258789
#88: episode_reward:-0.8412 acc: 42.2775, ratio: 0.4376
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 17644 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.05it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.83it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.78it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.78it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.77it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  53.282039642333984
Current Flops before reward:  5670107814
Perplexity in reward function  53.282039642333984
#89: episode_reward:-0.8929 acc: 53.2820, ratio: 0.4337
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.90it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.80it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.81it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.87it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.81it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.79it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.78it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.81it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
Perplexity after final layer :  35.436954498291016
Current Flops before reward:  5663967486
Perplexity in reward function  35.436954498291016
#90: episode_reward:-0.8012 acc: 35.4370, ratio: 0.4333
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.82it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.80it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.80it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  46.081756591796875
Current Flops before reward:  5735690286
Perplexity in reward function  46.081756591796875
#91: episode_reward:-0.8607 acc: 46.0818, ratio: 0.4387
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.03it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  51.59080505371094
Current Flops before reward:  5670297534
Perplexity in reward function  51.59080505371094
#92: episode_reward:-0.8856 acc: 51.5908, ratio: 0.4337
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.70it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.84it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.72it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.81it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.79it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.79it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.78it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.83it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.82it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.81it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.80it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
Perplexity after final layer :  39.96946716308594
Current Flops before reward:  5654501190
Perplexity in reward function  39.96946716308594
#93: episode_reward:-0.8282 acc: 39.9695, ratio: 0.4325
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.87it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.81it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.71it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.70it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  20.996671676635742
Current Flops before reward:  5688873486
Perplexity in reward function  20.996671676635742
#94: episode_reward:-0.6838 acc: 20.9967, ratio: 0.4352
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.86it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.78it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.79it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.78it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.79it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.77it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
Perplexity after final layer :  34.91264724731445
Current Flops before reward:  5686243614
Perplexity in reward function  34.91264724731445
#95: episode_reward:-0.7980 acc: 34.9126, ratio: 0.4350
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.91it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.80it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.95it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:05,  1.87it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.85it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.85it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.86it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.83it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.82it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.80it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:05<00:02,  1.80it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.80it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.81it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.83it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
Perplexity after final layer :  695.7842407226562
Current Flops before reward:  5717629398
Perplexity in reward function  695.7842407226562
#96: episode_reward:-1.4705 acc: 695.7842, ratio: 0.4374
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 17644 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.85it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.78it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.68it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  54.79270935058594
Current Flops before reward:  5649280974
Perplexity in reward function  54.79270935058594
#97: episode_reward:-0.8990 acc: 54.7927, ratio: 0.4321
GPU memory occupied: 17644 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  31.06524658203125
Current Flops before reward:  5656830870
Perplexity in reward function  31.06524658203125
#98: episode_reward:-0.7716 acc: 31.0652, ratio: 0.4327
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.97it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.91it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:05,  1.85it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.83it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.80it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.80it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.81it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.84it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.82it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.82it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.82it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.80it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.85it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]
Perplexity after final layer :  23.498878479003906
Current Flops before reward:  5623320150
Perplexity in reward function  23.498878479003906
#99: episode_reward:-0.7087 acc: 23.4989, ratio: 0.4302
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.69it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.64it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  39.189090728759766
Current Flops before reward:  5729973822
Perplexity in reward function  39.189090728759766
#100: episode_reward:-0.8243 acc: 39.1891, ratio: 0.4383
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.03it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.86it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  29.13713836669922
Current Flops before reward:  5665993902
Perplexity in reward function  29.13713836669922
#101: episode_reward:-0.7573 acc: 29.1371, ratio: 0.4334
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.87it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.85it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.83it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.81it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.79it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.81it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.82it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.82it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.80it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
Perplexity after final layer :  33.193294525146484
Current Flops before reward:  6392546430
Perplexity in reward function  33.193294525146484
#102: episode_reward:-0.7908 acc: 33.1933, ratio: 0.4890
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  107.77436828613281
Current Flops before reward:  6244484982
Perplexity in reward function  107.77436828613281
#103: episode_reward:-1.0556 acc: 107.7744, ratio: 0.4777
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.82it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.80it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  72.2958984375
Current Flops before reward:  6757122798
Perplexity in reward function  72.2958984375
#104: episode_reward:-0.9689 acc: 72.2959, ratio: 0.5169
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 17644 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.80it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.84it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.80it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  51.17967987060547
Current Flops before reward:  6500677542
Perplexity in reward function  51.17967987060547
#105: episode_reward:-0.8892 acc: 51.1797, ratio: 0.4973
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.84it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  66.47801208496094
Current Flops before reward:  6674251710
Perplexity in reward function  66.47801208496094
#106: episode_reward:-0.9494 acc: 66.4780, ratio: 0.5105
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  42.38114547729492
Current Flops before reward:  6771009798
Perplexity in reward function  42.38114547729492
#107: episode_reward:-0.8481 acc: 42.3811, ratio: 0.5179
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.86it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.77it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.84it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.85it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.87it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.86it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.84it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.83it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.83it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
Perplexity after final layer :  62.31193542480469
Current Flops before reward:  6903966750
Perplexity in reward function  62.31193542480469
#108: episode_reward:-0.9362 acc: 62.3119, ratio: 0.5281
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.85it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.78it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.79it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  187.3665771484375
Current Flops before reward:  6967776222
Perplexity in reward function  187.3665771484375
#109: episode_reward:-1.1861 acc: 187.3666, ratio: 0.5330
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.79it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  237.11212158203125
Current Flops before reward:  6748065798
Perplexity in reward function  237.11212158203125
#110: episode_reward:-1.2377 acc: 237.1121, ratio: 0.5162
GPU memory occupied: 17644 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.94it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.79it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.85it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.77it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.78it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.85it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
Perplexity after final layer :  185.7559814453125
Current Flops before reward:  6860260782
Perplexity in reward function  185.7559814453125
#111: episode_reward:-1.1833 acc: 185.7560, ratio: 0.5248
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.88it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.86it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.81it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.78it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.77it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  420.58074951171875
Current Flops before reward:  6956221710
Perplexity in reward function  420.58074951171875
#112: episode_reward:-1.3692 acc: 420.5807, ratio: 0.5321
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 17644 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.81it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.79it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.80it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  55.27517318725586
Current Flops before reward:  6939032982
Perplexity in reward function  55.27517318725586
#113: episode_reward:-0.9092 acc: 55.2752, ratio: 0.5308
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.88it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.81it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.81it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.80it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.85it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.86it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.84it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.82it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.81it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.80it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.81it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.86it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.83it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
Perplexity after final layer :  597.8862915039062
Current Flops before reward:  6970296534
Perplexity in reward function  597.8862915039062
#114: episode_reward:-1.4491 acc: 597.8863, ratio: 0.5332
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.87it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.80it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.79it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:05,  1.86it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.77it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
Perplexity after final layer :  262.9063415527344
Current Flops before reward:  6963238902
Perplexity in reward function  262.9063415527344
#115: episode_reward:-1.2628 acc: 262.9063, ratio: 0.5327
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.88it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.80it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  629.3733520507812
Current Flops before reward:  6989939982
Perplexity in reward function  629.3733520507812
#116: episode_reward:-1.4609 acc: 629.3734, ratio: 0.5347
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.90it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.81it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.81it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.81it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.80it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.80it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
Perplexity after final layer :  55.5814208984375
Current Flops before reward:  5945198862
Perplexity in reward function  55.5814208984375
#117: episode_reward:-0.9043 acc: 55.5814, ratio: 0.4548
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.89it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.67it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.78it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.78it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  58.5423698425293
Current Flops before reward:  5708725926
Perplexity in reward function  58.5423698425293
#118: episode_reward:-0.9143 acc: 58.5424, ratio: 0.4367
GPU memory occupied: 17644 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  32.91391372680664
Current Flops before reward:  5672912118
Perplexity in reward function  32.91391372680664
#119: episode_reward:-0.7847 acc: 32.9139, ratio: 0.4339
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.91it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.90it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.88it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:05,  1.92it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.96it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.97it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.97it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.89it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.86it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.85it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:05<00:02,  1.87it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.84it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:06<00:01,  1.80it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.81it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.86it/s]
Perplexity after final layer :  32.1536979675293
Current Flops before reward:  5682505350
Perplexity in reward function  32.1536979675293
#120: episode_reward:-0.7795 acc: 32.1537, ratio: 0.4347
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.73it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.85it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.81it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
Perplexity after final layer :  31.721323013305664
Current Flops before reward:  5688361950
Perplexity in reward function  31.721323013305664
#121: episode_reward:-0.7765 acc: 31.7213, ratio: 0.4351
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.00it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.77it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  28.823829650878906
Current Flops before reward:  5682416958
Perplexity in reward function  28.823829650878906
#122: episode_reward:-0.7549 acc: 28.8238, ratio: 0.4347
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.99it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.90it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.84it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.81it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.80it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.81it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.79it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.83it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.85it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.82it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.81it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.80it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.83it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
Perplexity after final layer :  19.179174423217773
Current Flops before reward:  5636930478
Perplexity in reward function  19.179174423217773
#123: episode_reward:-0.6632 acc: 19.1792, ratio: 0.4312
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.82it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.68it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.69it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  25.217710494995117
Current Flops before reward:  5691791790
Perplexity in reward function  25.217710494995117
#124: episode_reward:-0.7250 acc: 25.2177, ratio: 0.4354
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.80it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  22.549001693725586
Current Flops before reward:  5715129798
Perplexity in reward function  22.549001693725586
#125: episode_reward:-0.7000 acc: 22.5490, ratio: 0.4372
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 17644 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.07it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.89it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.92it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:05,  1.87it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.84it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.82it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.80it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.79it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.80it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:05<00:02,  1.83it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.81it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.80it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]
Perplexity after final layer :  16.40587615966797
Current Flops before reward:  5690961246
Perplexity in reward function  16.40587615966797
#126: episode_reward:-0.6284 acc: 16.4059, ratio: 0.4353
GPU memory occupied: 17644 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.70it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.70it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.68it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  19.706653594970703
Current Flops before reward:  5689743294
Perplexity in reward function  19.706653594970703
#127: episode_reward:-0.6696 acc: 19.7067, ratio: 0.4352
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  2.00it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.84it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  17.47381019592285
Current Flops before reward:  5658271926
Perplexity in reward function  17.47381019592285
#128: episode_reward:-0.6424 acc: 17.4738, ratio: 0.4328
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.87it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.81it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.80it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.84it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.82it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.81it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.79it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
Perplexity after final layer :  19.68574333190918
Current Flops before reward:  5687301966
Perplexity in reward function  19.68574333190918
#129: episode_reward:-0.6693 acc: 19.6857, ratio: 0.4350
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.81it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.78it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  18.484779357910156
Current Flops before reward:  5700350190
Perplexity in reward function  18.484779357910156
#130: episode_reward:-0.6553 acc: 18.4848, ratio: 0.4360
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.94it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.70it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.70it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.69it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  24.457656860351562
Current Flops before reward:  5633227230
Perplexity in reward function  24.457656860351562
#131: episode_reward:-0.7178 acc: 24.4577, ratio: 0.4309
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.87it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.81it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.83it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.82it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.81it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.78it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.77it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
Perplexity after final layer :  37.36515426635742
Current Flops before reward:  5684157030
Perplexity in reward function  37.36515426635742
#132: episode_reward:-0.8133 acc: 37.3652, ratio: 0.4348
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.84it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.81it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.87it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.81it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.71it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.77it/s]
Perplexity after final layer :  29.41632652282715
Current Flops before reward:  5648977254
Perplexity in reward function  29.41632652282715
#133: episode_reward:-0.7593 acc: 29.4163, ratio: 0.4321
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 17644 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  2.00it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  36.771602630615234
Current Flops before reward:  5662052982
Perplexity in reward function  36.771602630615234
#134: episode_reward:-0.8095 acc: 36.7716, ratio: 0.4331
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.68it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.84it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.81it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.80it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.80it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.83it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.82it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.80it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.79it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.79it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.79it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.82it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
Perplexity after final layer :  19.045000076293945
Current Flops before reward:  5667365838
Perplexity in reward function  19.045000076293945
#135: episode_reward:-0.6618 acc: 19.0450, ratio: 0.4335
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.78it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.81it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.77it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  21.571928024291992
Current Flops before reward:  5687318886
Perplexity in reward function  21.571928024291992
#136: episode_reward:-0.6899 acc: 21.5719, ratio: 0.4350
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.84it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.87it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.80it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.77it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  19.166072845458984
Current Flops before reward:  5682046470
Perplexity in reward function  19.166072845458984
#137: episode_reward:-0.6633 acc: 19.1661, ratio: 0.4346
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.85it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.94it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.86it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.83it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.81it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.80it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.86it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.82it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.81it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.79it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.78it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.78it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
Perplexity after final layer :  15.187433242797852
Current Flops before reward:  5666362038
Perplexity in reward function  15.187433242797852
[92m New best reward: -0.6110, acc: 15.1874, compress: 0.4334[00m
[92m New best policy: [0.96875, 0.9588481104651163, 1.0, 0.9987281976744186, 1.0, 0.947765261627907, 0.84375, 0.8724563953488372, 0.90625, 0.9061591569767442, 0.9375, 0.8851744186046512, 1.0, 0.774890988372093, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5][00m
[92m New best d primes: [31, 10555, 32, 10994, 32, 10433, 27, 9604, 29, 9975, 30, 9744, 32, 8530, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504][00m
#138: episode_reward:-0.6110 acc: 15.1874, ratio: 0.4334
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:08,  1.30it/s]WikiText Validation:  33%|███▎      | 5/15 [00:03<00:06,  1.48it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.51it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.61it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:05<00:04,  1.65it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.67it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:06<00:02,  1.68it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.69it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.70it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:09<00:00,  1.65it/s]
Perplexity after final layer :  16.792156219482422
Current Flops before reward:  5682413430
Perplexity in reward function  16.792156219482422
#139: episode_reward:-0.6336 acc: 16.7922, ratio: 0.4347
GPU memory occupied: 17644 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.82it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  18.191471099853516
Current Flops before reward:  5671025118
Perplexity in reward function  18.191471099853516
#140: episode_reward:-0.6515 acc: 18.1915, ratio: 0.4338
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.08it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.89it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.84it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.81it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.83it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.82it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.80it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.79it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.80it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.79it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
Perplexity after final layer :  27.479310989379883
Current Flops before reward:  5706884526
Perplexity in reward function  27.479310989379883
#141: episode_reward:-0.7444 acc: 27.4793, ratio: 0.4365
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 17644 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.82it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  14.074941635131836
Current Flops before reward:  5707229862
Perplexity in reward function  14.074941635131836
[92m New best reward: -0.5941, acc: 14.0749, compress: 0.4366[00m
[92m New best policy: [1.0, 0.9046148255813954, 0.96875, 0.9058866279069767, 1.0, 0.9988190406976745, 0.90625, 0.9817405523255814, 0.96875, 0.953125, 0.875, 0.9743822674418605, 0.90625, 0.5093568313953488, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5][00m
[92m New best d primes: [32, 9958, 31, 9972, 32, 10995, 29, 10807, 31, 10492, 28, 10726, 29, 5607, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504][00m
#142: episode_reward:-0.5941 acc: 14.0749, ratio: 0.4366
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 21760 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.89it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.71it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.68it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  27.583620071411133
Current Flops before reward:  5694433878
Perplexity in reward function  27.583620071411133
#143: episode_reward:-0.7451 acc: 27.5836, ratio: 0.4356
GPU memory occupied: 21760 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.07it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.89it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.83it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.81it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.80it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.79it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.78it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.78it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.78it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.79it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.79it/s]
Perplexity after final layer :  21.635698318481445
Current Flops before reward:  5690624142
Perplexity in reward function  21.635698318481445
#144: episode_reward:-0.6906 acc: 21.6357, ratio: 0.4353
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.78it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.77it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.77it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  17.731731414794922
Current Flops before reward:  5667526158
Perplexity in reward function  17.731731414794922
#145: episode_reward:-0.6457 acc: 17.7317, ratio: 0.4335
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.78it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.74it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.71it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  18.385072708129883
Current Flops before reward:  5670163542
Perplexity in reward function  18.385072708129883
#146: episode_reward:-0.6539 acc: 18.3851, ratio: 0.4337
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.78it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  18.0238037109375
Current Flops before reward:  5696780934
Perplexity in reward function  18.0238037109375
#147: episode_reward:-0.6496 acc: 18.0238, ratio: 0.4358
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.73it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.72it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.71it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.79it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  16.805477142333984
Current Flops before reward:  5669789526
Perplexity in reward function  16.805477142333984
#148: episode_reward:-0.6337 acc: 16.8055, ratio: 0.4337
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.85it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.76it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  14.755678176879883
Current Flops before reward:  5693194758
Perplexity in reward function  14.755678176879883
#149: episode_reward:-0.6046 acc: 14.7557, ratio: 0.4355
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.71it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.77it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.69it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.65it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  15.375073432922363
Current Flops before reward:  5679282606
Perplexity in reward function  15.375073432922363
#150: episode_reward:-0.6138 acc: 15.3751, ratio: 0.4344
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.79it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.77it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  16.937288284301758
Current Flops before reward:  5691359238
Perplexity in reward function  16.937288284301758
#151: episode_reward:-0.6356 acc: 16.9373, ratio: 0.4354
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.89it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.70it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.70it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.69it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.67it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.68it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  15.282293319702148
Current Flops before reward:  5678136582
Perplexity in reward function  15.282293319702148
#152: episode_reward:-0.6124 acc: 15.2823, ratio: 0.4343
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.92it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.80it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  16.781658172607422
Current Flops before reward:  5694401670
Perplexity in reward function  16.781658172607422
#153: episode_reward:-0.6335 acc: 16.7817, ratio: 0.4356
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.99it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.73it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.77it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.77it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  19.084707260131836
Current Flops before reward:  5683013358
Perplexity in reward function  19.084707260131836
#154: episode_reward:-0.6623 acc: 19.0847, ratio: 0.4347
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.85it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  15.080596923828125
Current Flops before reward:  5661932382
Perplexity in reward function  15.080596923828125
#155: episode_reward:-0.6094 acc: 15.0806, ratio: 0.4331
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  16.491880416870117
Current Flops before reward:  5690529870
Perplexity in reward function  16.491880416870117
#156: episode_reward:-0.6296 acc: 16.4919, ratio: 0.4353
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.71it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.78it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.70it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  14.480082511901855
Current Flops before reward:  5664891126
Perplexity in reward function  14.480082511901855
#157: episode_reward:-0.6002 acc: 14.4801, ratio: 0.4333
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.74it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.71it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.70it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.70it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.66it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  14.75495719909668
Current Flops before reward:  5668447446
Perplexity in reward function  14.75495719909668
#158: episode_reward:-0.6045 acc: 14.7550, ratio: 0.4336
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.92it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.77it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  14.383787155151367
Current Flops before reward:  5685366294
Perplexity in reward function  14.383787155151367
#159: episode_reward:-0.5988 acc: 14.3838, ratio: 0.4349
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.02it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.74it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.69it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  13.322275161743164
Current Flops before reward:  5694372990
Perplexity in reward function  13.322275161743164
[92m New best reward: -0.5817, acc: 13.3223, compress: 0.4356[00m
[92m New best policy: [0.96875, 0.9916424418604651, 0.96875, 0.9513989825581395, 1.0, 0.9925508720930233, 0.96875, 0.9870094476744186, 1.0, 0.973655523255814, 1.0, 0.965843023255814, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5][00m
[92m New best d primes: [31, 10916, 31, 10473, 32, 10926, 31, 10865, 32, 10718, 32, 10632, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504, 16, 5504][00m
#160: episode_reward:-0.5817 acc: 13.3223, ratio: 0.4356
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.77it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.73it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.72it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  13.789311408996582
Current Flops before reward:  5686857654
Perplexity in reward function  13.789311408996582
#161: episode_reward:-0.5894 acc: 13.7893, ratio: 0.4350
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  2.00it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.84it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.79it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.77it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.76it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  19.85342788696289
Current Flops before reward:  5691016254
Perplexity in reward function  19.85342788696289
#162: episode_reward:-0.6713 acc: 19.8534, ratio: 0.4353
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.82it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.68it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.66it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  14.919550895690918
Current Flops before reward:  5679834582
Perplexity in reward function  14.919550895690918
#163: episode_reward:-0.6070 acc: 14.9196, ratio: 0.4345
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  2.00it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  15.309706687927246
Current Flops before reward:  5677449438
Perplexity in reward function  15.309706687927246
#164: episode_reward:-0.6128 acc: 15.3097, ratio: 0.4343
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:08,  1.66it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.72it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:07,  1.68it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  14.521434783935547
Current Flops before reward:  5659758582
Perplexity in reward function  14.521434783935547
#165: episode_reward:-0.6009 acc: 14.5214, ratio: 0.4329
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  2.00it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  16.750022888183594
Current Flops before reward:  5680117854
Perplexity in reward function  16.750022888183594
#166: episode_reward:-0.6330 acc: 16.7500, ratio: 0.4345
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.91it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.81it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.78it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  17.05228042602539
Current Flops before reward:  5689353990
Perplexity in reward function  17.05228042602539
#167: episode_reward:-0.6371 acc: 17.0523, ratio: 0.4352
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.78it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.78it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  16.256315231323242
Current Flops before reward:  5680407006
Perplexity in reward function  16.256315231323242
#168: episode_reward:-0.6263 acc: 16.2563, ratio: 0.4345
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.87it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.78it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.80it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.82it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.79it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.78it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.77it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.78it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.82it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.80it/s]
Perplexity after final layer :  16.597434997558594
Current Flops before reward:  5664892302
Perplexity in reward function  16.597434997558594
#169: episode_reward:-0.6309 acc: 16.5974, ratio: 0.4333
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.93it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.67it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  14.973845481872559
Current Flops before reward:  5669135766
Perplexity in reward function  14.973845481872559
#170: episode_reward:-0.6078 acc: 14.9738, ratio: 0.4337
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.82it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.80it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.74it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  15.471802711486816
Current Flops before reward:  5676305766
Perplexity in reward function  15.471802711486816
#171: episode_reward:-0.6152 acc: 15.4718, ratio: 0.4342
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.83it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.79it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.80it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.82it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.85it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.78it/s]
Perplexity after final layer :  17.382081985473633
Current Flops before reward:  5661364662
Perplexity in reward function  17.382081985473633
#172: episode_reward:-0.6412 acc: 17.3821, ratio: 0.4331
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.98it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.84it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.79it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.78it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  14.270025253295898
Current Flops before reward:  5656833222
Perplexity in reward function  14.270025253295898
#173: episode_reward:-0.5969 acc: 14.2700, ratio: 0.4327
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.86it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.74it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.76it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.76it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.76it/s]
Perplexity after final layer :  15.97033405303955
Current Flops before reward:  5653593558
Perplexity in reward function  15.97033405303955
#174: episode_reward:-0.6222 acc: 15.9703, ratio: 0.4325
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.78it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.78it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.69it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.69it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.69it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.70it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  17.55592155456543
Current Flops before reward:  5661879726
Perplexity in reward function  17.55592155456543
#175: episode_reward:-0.6435 acc: 17.5559, ratio: 0.4331
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.71it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.76it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.78it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  13.85662841796875
Current Flops before reward:  5663428446
Perplexity in reward function  13.85662841796875
#176: episode_reward:-0.5903 acc: 13.8566, ratio: 0.4332
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.76it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.77it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.66it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  15.574326515197754
Current Flops before reward:  5653335438
Perplexity in reward function  15.574326515197754
#177: episode_reward:-0.6165 acc: 15.5743, ratio: 0.4325
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.74it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.77it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  14.923893928527832
Current Flops before reward:  5653420302
Perplexity in reward function  14.923893928527832
#178: episode_reward:-0.6070 acc: 14.9239, ratio: 0.4325
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.74it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.78it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.70it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.68it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.77it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  13.785850524902344
Current Flops before reward:  5653822998
Perplexity in reward function  13.785850524902344
#179: episode_reward:-0.5892 acc: 13.7859, ratio: 0.4325
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.93it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.83it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.78it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.76it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.74it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.70it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  15.546116828918457
Current Flops before reward:  5655715878
Perplexity in reward function  15.546116828918457
#180: episode_reward:-0.6161 acc: 15.5461, ratio: 0.4326
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.77it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.83it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  14.683157920837402
Current Flops before reward:  5655743382
Perplexity in reward function  14.683157920837402
#181: episode_reward:-0.6033 acc: 14.6832, ratio: 0.4326
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.89it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:06,  1.86it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.79it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.75it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.75it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.76it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  16.377281188964844
Current Flops before reward:  5647312638
Perplexity in reward function  16.377281188964844
#182: episode_reward:-0.6278 acc: 16.3773, ratio: 0.4320
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.82it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.71it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:06,  1.66it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.75it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.76it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.74it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  15.539584159851074
Current Flops before reward:  5641720038
Perplexity in reward function  15.539584159851074
#183: episode_reward:-0.6160 acc: 15.5396, ratio: 0.4316
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.84it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.78it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.75it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.72it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  16.050552368164062
Current Flops before reward:  5657866878
Perplexity in reward function  16.050552368164062
#184: episode_reward:-0.6233 acc: 16.0506, ratio: 0.4328
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.89it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.78it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.84it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.75it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  16.112573623657227
Current Flops before reward:  5652274278
Perplexity in reward function  16.112573623657227
#185: episode_reward:-0.6242 acc: 16.1126, ratio: 0.4324
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.82it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.66it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  14.10681438446045
Current Flops before reward:  5649635718
Perplexity in reward function  14.10681438446045
#186: episode_reward:-0.5943 acc: 14.1068, ratio: 0.4322
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:06,  2.01it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.73it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  15.459896087646484
Current Flops before reward:  5649004758
Perplexity in reward function  15.459896087646484
#187: episode_reward:-0.6149 acc: 15.4599, ratio: 0.4321
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.85it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.71it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.72it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.69it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.75it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.69it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  15.483541488647461
Current Flops before reward:  5643440838
Perplexity in reward function  15.483541488647461
#188: episode_reward:-0.6152 acc: 15.4835, ratio: 0.4317
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.74it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.73it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.72it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  15.409077644348145
Current Flops before reward:  5641863438
Perplexity in reward function  15.409077644348145
#189: episode_reward:-0.6141 acc: 15.4091, ratio: 0.4316
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.72it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.77it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.72it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.76it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.76it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.74it/s]
Perplexity after final layer :  15.520636558532715
Current Flops before reward:  5646710358
Perplexity in reward function  15.520636558532715
#190: episode_reward:-0.6157 acc: 15.5206, ratio: 0.4319
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.79it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.82it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.78it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.77it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.74it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.73it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.73it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.78it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.75it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  13.936848640441895
Current Flops before reward:  5647398678
Perplexity in reward function  13.936848640441895
#191: episode_reward:-0.5916 acc: 13.9368, ratio: 0.4320
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.80it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.74it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.74it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.78it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.70it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:03,  1.65it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  14.104455947875977
Current Flops before reward:  5647857558
Perplexity in reward function  14.104455947875977
#192: episode_reward:-0.5943 acc: 14.1045, ratio: 0.4320
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.93it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.80it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.73it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.74it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.72it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.73it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.73it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.75it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.73it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]
Perplexity after final layer :  15.611696243286133
Current Flops before reward:  5644788798
Perplexity in reward function  15.611696243286133
#193: episode_reward:-0.6170 acc: 15.6117, ratio: 0.4318
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.81it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.76it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.76it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.83it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.86it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.87it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.96it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.98it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:05<00:02,  1.84it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.86it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.84it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.82it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.84it/s]
Perplexity after final layer :  15.549397468566895
Current Flops before reward:  5643698958
Perplexity in reward function  15.549397468566895
#194: episode_reward:-0.6161 acc: 15.5494, ratio: 0.4317
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.83it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.77it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.75it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.75it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.74it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.74it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.74it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.75it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.74it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.75it/s]
Perplexity after final layer :  15.526471138000488
Current Flops before reward:  5643842358
Perplexity in reward function  15.526471138000488
#195: episode_reward:-0.6158 acc: 15.5265, ratio: 0.4317
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.77it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.75it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.71it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.72it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.72it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.72it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.71it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.78it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.70it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.65it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]
Perplexity after final layer :  14.495789527893066
Current Flops before reward:  5641920798
Perplexity in reward function  14.495789527893066
#196: episode_reward:-0.6004 acc: 14.4958, ratio: 0.4316
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.88it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.82it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.80it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.79it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.79it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:04,  1.84it/s]WikiText Validation:  47%|████▋     | 7/15 [00:03<00:04,  1.81it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:03,  1.80it/s]WikiText Validation:  60%|██████    | 9/15 [00:04<00:03,  1.79it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.79it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.79it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.77it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.85it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:07<00:00,  1.82it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.81it/s]
Perplexity after final layer :  15.465187072753906
Current Flops before reward:  5642781198
Perplexity in reward function  15.465187072753906
#197: episode_reward:-0.6149 acc: 15.4652, ratio: 0.4316
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 272 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.79it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.76it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.73it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.72it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.71it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.71it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.70it/s]WikiText Validation:  80%|████████  | 12/15 [00:07<00:01,  1.65it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.71it/s]
Perplexity after final layer :  15.411458969116211
Current Flops before reward:  5641089078
Perplexity in reward function  15.411458969116211
#198: episode_reward:-0.6141 acc: 15.4115, ratio: 0.4315
GPU memory occupied: 272 MB.
Trying to load using pretrained
GPU memory occupied: 13608 MB.
nsamples 15
WikiText Validation:   0%|          | 0/15 [00:00<?, ?it/s]WikiText Validation:   7%|▋         | 1/15 [00:00<00:07,  1.90it/s]WikiText Validation:  13%|█▎        | 2/15 [00:01<00:07,  1.77it/s]WikiText Validation:  20%|██        | 3/15 [00:01<00:06,  1.75it/s]WikiText Validation:  27%|██▋       | 4/15 [00:02<00:06,  1.74it/s]WikiText Validation:  33%|███▎      | 5/15 [00:02<00:05,  1.73it/s]WikiText Validation:  40%|████      | 6/15 [00:03<00:05,  1.73it/s]WikiText Validation:  47%|████▋     | 7/15 [00:04<00:04,  1.71it/s]WikiText Validation:  53%|█████▎    | 8/15 [00:04<00:04,  1.71it/s]WikiText Validation:  60%|██████    | 9/15 [00:05<00:03,  1.71it/s]WikiText Validation:  67%|██████▋   | 10/15 [00:05<00:02,  1.71it/s]WikiText Validation:  73%|███████▎  | 11/15 [00:06<00:02,  1.71it/s]WikiText Validation:  80%|████████  | 12/15 [00:06<00:01,  1.70it/s]WikiText Validation:  87%|████████▋ | 13/15 [00:07<00:01,  1.71it/s]WikiText Validation:  93%|█████████▎| 14/15 [00:08<00:00,  1.71it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.73it/s]WikiText Validation: 100%|██████████| 15/15 [00:08<00:00,  1.72it/s]
Perplexity after final layer :  15.553231239318848
Current Flops before reward:  5645247678
Perplexity in reward function  15.553231239318848
#199: episode_reward:-0.6162 acc: 15.5532, ratio: 0.4318
Traceback (most recent call last):
  File "/data/home/milinbhade/Milin/AMC/amc_wanda/amc_search.py", line 371, in <module>
    text_writer.write("Time taken: {} seconds".format(end_time - start_time))
ValueError: I/O operation on closed file.
